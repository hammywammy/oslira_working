<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Campaign Management - Oslira</title>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://js.sentry-cdn.com https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self' https:; font-src 'self' data:;">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #F5F9FF;
            min-height: 100vh;
        }

        .dashboard {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: white;
            box-shadow: 2px 0 10px rgba(45, 108, 223, 0.1);
            padding: 24px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: #2D6CDF;
            margin-bottom: 40px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-image {
            width: 32px;
            height: 32px;
            object-fit: contain;
        }

        .menu {
            margin-bottom: 32px;
        }

        .menu-section {
            margin-bottom: 24px;
        }

        .menu-section h4 {
            font-size: 12px;
            text-transform: uppercase;
            color: #6B7280;
            margin-bottom: 8px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .menu a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            text-decoration: none;
            color: #6B7280;
            border-radius: 8px;
            margin-bottom: 4px;
            transition: all 0.2s ease;
            font-weight: 500;
            cursor: pointer;
        }

        .menu a:hover, .menu a.active {
            background-color: #2D6CDF;
            color: white;
            transform: translateX(2px);
        }

        .menu a .icon {
            font-size: 18px;
            width: 20px;
        }

        .subscription-status {
            background: linear-gradient(135deg, #53E1C5 0%, #8A6DF1 100%);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
            color: white;
        }

        .subscription-status h4 {
            margin-bottom: 8px;
            font-size: 14px;
            opacity: 0.9;
        }

        .plan-name {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .subscription-status a {
            color: white;
            text-decoration: none;
            font-size: 14px;
            opacity: 0.9;
            border-bottom: 1px solid rgba(255,255,255,0.3);
            cursor: pointer;
        }

        .user-info {
            padding-top: 20px;
            border-top: 1px solid #C9CEDC;
        }

        .user-info p {
            margin-bottom: 8px;
            color: #6B7280;
            font-size: 14px;
        }

        .user-info a {
            color: #8A6DF1;
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 24px;
            background: #F5F9FF;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(45, 108, 223, 0.1);
        }

        header h1 {
            color: #121417;
            font-size: 28px;
            font-weight: 700;
        }

        .header-subtitle {
            color: #6B7280;
            font-size: 16px;
            margin-top: 4px;
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        /* Campaign Views */
        .campaign-view {
            display: none;
        }

        .campaign-view.active {
            display: block;
        }

        /* Campaign Overview */
        .campaign-overview {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 24px;
            margin-bottom: 32px;
        }

        .campaigns-list {
            background: white;
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 4px 20px rgba(45, 108, 223, 0.1);
            border: 1px solid rgba(45, 108, 223, 0.1);
        }

        .list-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 24px;
        }

        .list-title {
            font-size: 24px;
            font-weight: 700;
            color: #121417;
        }

        .campaign-filters {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .filter-chip {
            padding: 6px 12px;
            background: #F5F9FF;
            border: 1px solid #C9CEDC;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 500;
            color: #6B7280;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .filter-chip.active {
            background: #2D6CDF;
            color: white;
            border-color: #2D6CDF;
        }

        .campaign-card {
            background: linear-gradient(135deg, #F5F9FF, #E8F3FF);
            border: 1px solid #C9CEDC;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .campaign-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(45, 108, 223, 0.15);
            border-color: #2D6CDF;
        }

        .campaign-card.active {
            border-color: #2D6CDF;
            background: linear-gradient(135deg, #E8F3FF, #F0F4FF);
        }

        .campaign-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .campaign-name {
            font-size: 18px;
            font-weight: 600;
            color: #121417;
        }

        .campaign-status {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-draft { background: #E5E7EB; color: #374151; }
        .status-ready { background: #FEF3C7; color: #92400E; }
        .status-live { background: #D1FAE5; color: #065F46; }
        .status-paused { background: #FEE2E2; color: #991B1B; }
        .status-completed { background: #E0E7FF; color: #3730A3; }

        .campaign-metrics {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 12px;
        }

        .metric-item {
            text-align: center;
            padding: 8px;
            background: white;
            border-radius: 6px;
        }

        .metric-value {
            font-size: 16px;
            font-weight: 700;
            color: #2D6CDF;
        }

        .metric-label {
            font-size: 10px;
            color: #6B7280;
            text-transform: uppercase;
            font-weight: 500;
        }

        .campaign-objective {
            font-size: 12px;
            color: #6B7280;
            margin-bottom: 8px;
        }

        .campaign-progress {
            height: 4px;
            background: #E5E7EB;
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #2D6CDF, #8A6DF1);
            transition: width 0.3s ease;
        }

        /* Campaign Stats Panel */
        .campaign-stats-panel {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .stats-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(45, 108, 223, 0.1);
            border: 1px solid #C9CEDC;
        }

        .stats-title {
            font-size: 16px;
            font-weight: 600;
            color: #121417;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .performance-chart {
            height: 120px;
            background: #F5F9FF;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
            border: 1px solid #C9CEDC;
        }

        .chart-placeholder {
            color: #6B7280;
            font-size: 12px;
            text-align: center;
        }

        /* Campaign Creation Wizard */
        .wizard-container {
            background: white;
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 4px 20px rgba(45, 108, 223, 0.1);
            border: 1px solid rgba(45, 108, 223, 0.1);
        }

        .wizard-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .wizard-title {
            font-size: 28px;
            font-weight: 700;
            color: #121417;
            margin-bottom: 8px;
        }

        .wizard-subtitle {
            color: #6B7280;
            font-size: 16px;
        }

        .wizard-progress {
            display: flex;
            justify-content: center;
            margin-bottom: 32px;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .step-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #C9CEDC;
            color: #6B7280;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
        }

        .step-number.active {
            background: #2D6CDF;
            color: white;
        }

        .step-number.completed {
            background: #10B981;
            color: white;
        }

        .step-divider {
            width: 40px;
            height: 2px;
            background: #C9CEDC;
            margin: 0 8px;
        }

        .step-divider.completed {
            background: #10B981;
        }

        .wizard-step {
            display: none;
        }

        .wizard-step.active {
            display: block;
        }

        .step-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .step-title {
            font-size: 24px;
            font-weight: 700;
            color: #121417;
            margin-bottom: 8px;
        }

        .step-description {
            color: #6B7280;
            font-size: 16px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #121417;
            font-size: 14px;
        }

        .form-help {
            font-size: 12px;
            color: #6B7280;
            margin-top: 2px;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #C9CEDC;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s ease;
            background: #F5F9FF;
        }

        .form-input:focus {
            outline: none;
            border-color: #2D6CDF;
            background: white;
            box-shadow: 0 0 0 4px rgba(45, 108, 223, 0.1);
        }

        .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #C9CEDC;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
        }

        .form-textarea {
            width: 100%;
            min-height: 100px;
            padding: 12px 16px;
            border: 2px solid #C9CEDC;
            border-radius: 8px;
            font-size: 14px;
            resize: vertical;
            background: #F5F9FF;
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #2D6CDF, #8A6DF1);
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            box-shadow: 0 4px 12px rgba(45, 108, 223, 0.3);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 8px 20px rgba(45, 108, 223, 0.4);
        }

        .btn-secondary {
            background: white;
            color: #2D6CDF;
            border: 2px solid #2D6CDF;
        }

        .btn-secondary:hover {
            background: #2D6CDF;
            color: white;
        }

        .btn-danger {
            background: #EF4444;
            color: white;
        }

        .btn-danger:hover {
            background: #DC2626;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .wizard-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 32px;
        }

        /* Claude Insights */
        .claude-insight {
            background: linear-gradient(135deg, #E8F3FF, #F0F4FF);
            border: 2px solid #2D6CDF;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .claude-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .claude-title {
            font-weight: 600;
            color: #2D6CDF;
            font-size: 16px;
        }

        .claude-content {
            color: #1E3A8A;
            line-height: 1.5;
        }

        /* Message Variant Lab */
        .variant-lab {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-top: 24px;
        }

        .variant-editor {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #C9CEDC;
        }

        .variant-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .variant-name {
            font-weight: 600;
            color: #121417;
        }

        .fitness-score {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            background: #D1FAE5;
            color: #065F46;
        }

        .message-textarea {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 2px solid #C9CEDC;
            border-radius: 8px;
            font-size: 14px;
            resize: vertical;
            margin-bottom: 16px;
        }

        .variant-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 16px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .control-label {
            font-size: 10px;
            color: #6B7280;
            font-weight: 500;
            text-transform: uppercase;
        }

        .control-select {
            padding: 6px 8px;
            border: 1px solid #C9CEDC;
            border-radius: 4px;
            font-size: 12px;
        }

        /* Live Campaign Ops */
        .ops-hub {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 24px;
            margin-top: 24px;
        }

        .ops-main {
            background: white;
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 4px 20px rgba(45, 108, 223, 0.1);
        }

        .ops-sidebar {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .campaign-timeline {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #C9CEDC;
        }

        .timeline-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid #F5F9FF;
        }

        .timeline-item:last-child {
            border-bottom: none;
        }

        .timeline-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #E8F3FF;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .timeline-content {
            flex: 1;
        }

        .timeline-title {
            font-weight: 600;
            color: #121417;
            font-size: 14px;
        }

        .timeline-time {
            font-size: 12px;
            color: #6B7280;
        }

        /* Feedback Intelligence */
        .feedback-panel {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #C9CEDC;
        }

        .feedback-summary {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 20px;
        }

        .feedback-metric {
            text-align: center;
            padding: 12px;
            background: #F5F9FF;
            border-radius: 8px;
        }

        .feedback-value {
            font-size: 20px;
            font-weight: 700;
            color: #2D6CDF;
        }

        .feedback-label {
            font-size: 12px;
            color: #6B7280;
            margin-top: 4px;
        }

        .feedback-themes {
            margin-top: 16px;
        }

        .theme-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #F5F9FF;
        }

        .theme-text {
            font-size: 14px;
            color: #121417;
        }

        .theme-count {
            font-size: 12px;
            color: #6B7280;
            background: #E8F3FF;
            padding: 2px 6px;
            border-radius: 10px;
        }

        /* Metrics Grid */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .metric-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(45, 108, 223, 0.1);
            border: 1px solid #C9CEDC;
        }

        .metric-number {
            font-size: 32px;
            font-weight: 700;
            color: #2D6CDF;
            margin-bottom: 4px;
        }

        .metric-change {
            font-size: 12px;
            font-weight: 500;
        }

        .metric-change.positive {
            color: #10B981;
        }

        .metric-change.negative {
            color: #EF4444;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .campaign-overview {
                grid-template-columns: 1fr;
            }

            .variant-lab {
                grid-template-columns: 1fr;
            }

            .ops-hub {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
                z-index: 1000;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .wizard-progress {
                overflow-x: auto;
            }

            .logo {
                font-size: 20px;
            }

            .logo-image {
                width: 28px;
                height: 28px;
            }
        }

        /* Loading states */
        .loading {
            opacity: 0.7;
            pointer-events: none;
            position: relative;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #2D6CDF;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        button:focus,
        input:focus,
        select:focus,
        textarea:focus,
        a:focus {
            outline: 2px solid #2D6CDF;
            outline-offset: 2px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 8px;
            z-index: 1000;
            animation: slideIn 0.3s ease;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .notification-error {
            background: #EF4444;
            color: white;
        }

        .notification-success {
            background: #10B981;
            color: white;
        }

        .notification-info {
            background: #2D6CDF;
            color: white;
        }
    </style>
</head>
<body class="dashboard">
    <aside class="sidebar">
        <div class="logo">
            <img src="./assets/oslira-logo.png" alt="Oslira Logo" class="logo-image">
            Oslira
        </div>
        
        <nav class="menu">
            <div class="menu-section">
                <h4>Main</h4>
                <a href="dashboard.html" data-page="dashboard">
                    <span class="icon">📊</span>
                    Dashboard
                </a>
                <a href="leads.html" data-page="leads">
                    <span class="icon">🔍</span>
                    Lead Research
                </a>
                <a href="analytics.html" data-page="analytics">
                    <span class="icon">📈</span>
                    Analytics
                </a>
            </div>
            
            <div class="menu-section">
                <h4>Tools</h4>
                <a href="campaigns.html" data-page="campaigns" class="active">
                    <span class="icon">🚀</span>
                    Campaigns
                </a>
                <a href="messages.html" data-page="messages">
                    <span class="icon">💬</span>
                    Message Studio
                </a>
                <a href="integrations.html" data-page="integrations">
                    <span class="icon">🔗</span>
                    Integrations
                </a>
            </div>
            
            <div class="menu-section">
                <h4>Account</h4>
                <a href="subscription.html" data-page="subscription">
                    <span class="icon">💳</span>
                    Subscription
                </a>
                <a href="settings.html" data-page="settings">
                    <span class="icon">⚙️</span>
                    Settings
                </a>
            </div>
        </nav>
        
        <div class="subscription-status">
            <h4>Current Plan</h4>
            <p class="plan-name" id="plan-name">Loading...</p>
            <a href="subscription.html" data-page="subscription">Manage Subscription</a>
        </div>
        
        <div class="user-info">
            <p id="user-email">Loading...</p>
            <a href="javascript:void(0)" id="logout-btn">Sign Out</a>
        </div>
    </aside>
    
    <main class="main-content">
        <header>
            <div>
                <h1>Campaign Management</h1>
                <p class="header-subtitle">Strategic operating system for AI-powered outreach sequences</p>
            </div>
            <div class="header-actions">
                <button class="btn btn-secondary" id="campaign-templates-btn">
                    📋 Templates
                </button>
                <button class="btn btn-secondary" id="bulk-import-btn">
                    📤 Bulk Import
                </button>
                <button class="btn btn-primary" id="new-campaign-btn">
                    🚀 New Campaign
                </button>
            </div>
        </header>
        
        <!-- Campaign Overview View -->
        <div id="overview-view" class="campaign-view active">
            <div class="campaign-overview">
                <!-- Campaigns List -->
                <div class="campaigns-list">
                    <div class="list-header">
                        <h2 class="list-title">Active Campaigns</h2>
                    </div>
                    
                    <div class="campaign-filters">
                        <div class="filter-chip active" data-filter="all">All</div>
                        <div class="filter-chip" data-filter="live">Live</div>
                        <div class="filter-chip" data-filter="draft">Draft</div>
                        <div class="filter-chip" data-filter="completed">Completed</div>
                        <div class="filter-chip" data-filter="growth">Growth</div>
                        <div class="filter-chip" data-filter="testing">Testing</div>
                    </div>
                    
                    <div id="campaigns-container">
                        <!-- Campaigns will be loaded dynamically -->
                    </div>
                </div>
                
                <!-- Campaign Stats Panel -->
                <div class="campaign-stats-panel">
                    <div class="stats-card">
                        <div class="stats-title">
                            <span>📊</span>
                            Performance Overview
                        </div>
                        <div class="performance-chart">
                            <div class="chart-placeholder">
                                Response Rate Trend<br>
                                <small>Interactive chart showing daily response rates</small>
                            </div>
                        </div>
                        <div class="campaign-metrics">
                            <div class="metric-item">
                                <div class="metric-value" id="avg-response-rate">--</div>
                                <div class="metric-label">Avg Response Rate</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" id="conversion-rate">--</div>
                                <div class="metric-label">Conversion Rate</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-title">
                            <span>🧠</span>
                            Claude Insights
                        </div>
                        <div class="claude-insight">
                            <div class="claude-header">
                                <span>🎯</span>
                                <div class="claude-title">Daily Recommendation</div>
                            </div>
                            <div class="claude-content" id="daily-recommendation">
                                Loading recommendations...
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-title">
                            <span>📈</span>
                            Live Campaign Activity
                        </div>
                        <div class="campaign-timeline" id="campaign-timeline">
                            <!-- Timeline items will be loaded dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Campaign Creation Wizard View -->
        <div id="wizard-view" class="campaign-view">
            <div class="wizard-container">
                <div class="wizard-header">
                    <h2 class="wizard-title">Campaign Creation Wizard 2.0</h2>
                    <p class="wizard-subtitle">Claude-assisted campaign creation with intelligent recommendations</p>
                </div>
                
                <div class="wizard-progress">
                    <div class="progress-step">
                        <div class="step-number active" id="step-1-indicator">1</div>
                        <div class="step-divider"></div>
                        <div class="step-number" id="step-2-indicator">2</div>
                        <div class="step-divider"></div>
                        <div class="step-number" id="step-3-indicator">3</div>
                        <div class="step-divider"></div>
                        <div class="step-number" id="step-4-indicator">4</div>
                    </div>
                </div>
                
                <!-- Step 1: Campaign Basics -->
                <div id="wizard-step-1" class="wizard-step active">
                    <div class="step-header">
                        <h3 class="step-title">Campaign Foundation</h3>
                        <p class="step-description">Define your campaign's core objectives and targeting strategy</p>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="campaign-name" class="form-label">
                                Campaign Name
                                <div class="form-help">Choose a descriptive name for easy identification</div>
                            </label>
                            <input type="text" id="campaign-name" class="form-input" placeholder="e.g., SaaS Founder Q1 Outreach" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="campaign-objective" class="form-label">
                                Primary Objective
                                <div class="form-help">What's the main goal of this campaign?</div>
                            </label>
                            <select id="campaign-objective" class="form-select" required>
                                <option value="">Select objective...</option>
                                <option value="growth">Growth - Scale outreach volume</option>
                                <option value="testing">Testing - Optimize message performance</option>
                                <option value="high-stakes">High-Stakes - Target premium leads</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="crm-integration" class="form-label">
                                CRM Integration
                                <div class="form-help">Connect to your existing CRM system</div>
                            </label>
                            <select id="crm-integration" class="form-select">
                                <option value="">Select CRM...</option>
                                <option value="hubspot">HubSpot</option>
                                <option value="salesforce">Salesforce</option>
                                <option value="pipedrive">Pipedrive</option>
                                <option value="airtable">Airtable</option>
                                <option value="custom">Custom/Other</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="outreach-mode" class="form-label">
                                Outreach Mode
                                <div class="form-help">What's your relationship with these leads?</div>
                            </label>
                            <select id="outreach-mode" class="form-select" required>
                                <option value="">Select mode...</option>
                                <option value="cold">Cold - No prior interaction</option>
                                <option value="warm">Warm - Some engagement history</option>
                                <option value="re-engage">Re-engage - Previous customers/contacts</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="claude-insight">
                        <div class="claude-header">
                            <span>🧠</span>
                            <div class="claude-title">Campaign Setup Insights</div>
                        </div>
                        <div class="claude-content" id="step1-claude-insights">
                            Based on your selections, Claude will provide strategic recommendations for campaign structure, messaging approach, and expected performance benchmarks.
                        </div>
                    </div>
                    
                    <div class="wizard-actions">
                        <div></div>
                        <button class="btn btn-primary" id="step-1-next">
                            Continue to Lead Selection →
                        </button>
                    </div>
                </div>
                
                <!-- Step 2: Lead Assignment -->
                <div id="wizard-step-2" class="wizard-step">
                    <div class="step-header">
                        <h3 class="step-title">Lead Assignment & ICP</h3>
                        <p class="step-description">Select leads and configure targeting parameters</p>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="lead-source" class="form-label">
                                Lead Source
                                <div class="form-help">How will leads be added to this campaign?</div>
                            </label>
                            <select id="lead-source" class="form-select">
                                <option value="">Select source...</option>
                                <option value="manual">Manual Selection</option>
                                <option value="list-upload">CSV/List Upload</option>
                                <option value="tags">From Saved Tags</option>
                                <option value="claude-batch">Claude Smart Batching</option>
                                <option value="lookalike">Lookalike Seeder</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="target-count" class="form-label">
                                Target Lead Count
                                <div class="form-help">How many leads do you want to reach?</div>
                            </label>
                            <input type="number" id="target-count" class="form-input" placeholder="e.g., 250" min="1" max="10000" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="icp-criteria" class="form-label">
                                ICP Criteria
                                <div class="form-help">Define your ideal customer profile</div>
                            </label>
                            <textarea id="icp-criteria" class="form-textarea" placeholder="e.g., SaaS founders with 10-100 employees, Series A-B stage, using HubSpot..." required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="exclusion-rules" class="form-label">
                                Exclusion Rules
                                <div class="form-help">Who should be excluded from this campaign?</div>
                            </label>
                            <textarea id="exclusion-rules" class="form-textarea" placeholder="e.g., Contacted in last 90 days, competitors, existing customers..."></textarea>
                        </div>
                    </div>
                    
                    <div class="claude-insight">
                        <div class="claude-header">
                            <span>🎯</span>
                            <div class="claude-title">Smart Lead Recommendations</div>
                        </div>
                        <div class="claude-content" id="step2-claude-insights">
                            Claude will analyze your ICP criteria and suggest optimal lead selection strategies, segment filtering, and batch sizing for maximum engagement.
                        </div>
                    </div>
                    
                    <div class="wizard-actions">
                        <button class="btn btn-secondary" id="step-2-back">
                            ← Back to Basics
                        </button>
                        <button class="btn btn-primary" id="step-2-next">
                            Continue to Messages →
                        </button>
                    </div>
                </div>
                
                <!-- Step 3: Message Variants -->
                <div id="wizard-step-3" class="wizard-step">
                    <div class="step-header">
                        <h3 class="step-title">Message Variant Lab</h3>
                        <p class="step-description">Create and optimize your outreach message variants</p>
                    </div>
                    
                    <div class="variant-lab">
                        <div class="variant-editor">
                            <div class="variant-header">
                                <div class="variant-name">Variant A - Control</div>
                                <div class="fitness-score">Fitness: 87</div>
                            </div>
                            <textarea class="message-textarea" id="variant-a-message" placeholder="Enter your message here..." required>Hi {{name}}! 👋

I noticed your recent post about scaling challenges at {{company}}. The struggle is real when you're growing fast!

I help SaaS founders like yourself automate their outreach without the overhead of hiring more SDRs. We just helped a similar Y Combinator startup book 47 qualified demos in 30 days.

Worth a quick 15-min chat to see if we could help you hit those aggressive Q4 targets you mentioned? 🚀</textarea>
                            
                            <div class="variant-controls">
                                <div class="control-group">
                                    <div class="control-label">Hook Style</div>
                                    <select class="control-select" id="variant-a-hook">
                                        <option value="direct">Direct</option>
                                        <option value="curiosity">Curiosity</option>
                                        <option value="value" selected>Value</option>
                                        <option value="question">Question</option>
                                        <option value="social-proof">Social Proof</option>
                                    </select>
                                </div>
                                <div class="control-group">
                                    <div class="control-label">CTA Type</div>
                                    <select class="control-select" id="variant-a-cta">
                                        <option value="dm-reply">DM Reply</option>
                                        <option value="calendar" selected>Calendar</option>
                                        <option value="website">Website</option>
                                        <option value="phone">Phone</option>
                                    </select>
                                </div>
                                <div class="control-group">
                                    <div class="control-label">Tone</div>
                                    <select class="control-select" id="variant-a-tone">
                                        <option value="casual">Casual</option>
                                        <option value="professional">Professional</option>
                                        <option value="consultative" selected>Consultative</option>
                                        <option value="direct">Direct</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div style="display: flex; gap: 8px;">
                                <button class="btn btn-secondary" id="claude-suggestions-a">🧠 Claude Suggestions</button>
                                <button class="btn btn-secondary" id="analyze-fitness-a">🔍 Analyze Fitness</button>
                            </div>
                        </div>
                        
                        <div class="variant-editor">
                            <div class="variant-header">
                                <div class="variant-name">Variant B - Test</div>
                                <div class="fitness-score">Fitness: 73</div>
                            </div>
                            <textarea class="message-textarea" id="variant-b-message" placeholder="Create a second variant...">Hey {{name}}! 

Quick question - what's your biggest challenge with lead generation right now?

I ask because I specialize in helping SaaS companies like {{company}} 3x their qualified pipeline through AI-powered outreach automation.

If you're open to it, I'd love to show you how we helped [Similar Company] go from 12 to 40 demos per month in 6 weeks.

Interested in a brief chat?</textarea>
                            
                            <div class="variant-controls">
                                <div class="control-group">
                                    <div class="control-label">Hook Style</div>
                                    <select class="control-select" id="variant-b-hook">
                                        <option value="direct">Direct</option>
                                        <option value="curiosity">Curiosity</option>
                                        <option value="value">Value</option>
                                        <option value="question" selected>Question</option>
                                        <option value="social-proof">Social Proof</option>
                                    </select>
                                </div>
                                <div class="control-group">
                                    <div class="control-label">CTA Type</div>
                                    <select class="control-select" id="variant-b-cta">
                                        <option value="dm-reply" selected>DM Reply</option>
                                        <option value="calendar">Calendar</option>
                                        <option value="website">Website</option>
                                        <option value="phone">Phone</option>
                                    </select>
                                </div>
                                <div class="control-group">
                                    <div class="control-label">Tone</div>
                                    <select class="control-select" id="variant-b-tone">
                                        <option value="casual" selected>Casual</option>
                                        <option value="professional">Professional</option>
                                        <option value="consultative">Consultative</option>
                                        <option value="direct">Direct</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div style="display: flex; gap: 8px;">
                                <button class="btn btn-secondary" id="add-variant-btn">➕ Add Variant</button>
                                <button class="btn btn-secondary" id="remove-variant-btn">🗑️ Remove</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="claude-insight">
                        <div class="claude-header">
                            <span>✍️</span>
                            <div class="claude-title">Message Optimization Insights</div>
                        </div>
                        <div class="claude-content" id="step3-claude-insights">
                            Variant A shows strong consultative approach suitable for SaaS segment. Variant B's question hook may perform better for discovery campaigns. Consider testing both with 50/50 split for optimal data collection.
                        </div>
                    </div>
                    
                    <div class="wizard-actions">
                        <button class="btn btn-secondary" id="step-3-back">
                            ← Back to Leads
                        </button>
                        <button class="btn btn-primary" id="step-3-next">
                            Continue to Review →
                        </button>
                    </div>
                </div>
                
                <!-- Step 4: Review & Launch -->
                <div id="wizard-step-4" class="wizard-step">
                    <div class="step-header">
                        <h3 class="step-title">Review & Launch</h3>
                        <p class="step-description">Final review of your campaign configuration before launch</p>
                    </div>
                    
                    <div class="form-grid">
                        <div class="stats-card">
                            <div class="stats-title">
                                <span>📋</span>
                                Campaign Summary
                            </div>
                            <div id="campaign-summary">
                                <div style="margin-bottom: 16px;">
                                    <strong>Name:</strong> <span id="summary-name">--</span><br>
                                    <strong>Objective:</strong> <span id="summary-objective">--</span><br>
                                    <strong>Mode:</strong> <span id="summary-mode">--</span><br>
                                    <strong>Target Leads:</strong> <span id="summary-leads">--</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stats-card">
                            <div class="stats-title">
                                <span>🎯</span>
                                Claude Risk Assessment
                            </div>
                            <div class="claude-insight">
                                <div class="claude-content" id="risk-assessment">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                                        <span>Risk Score:</span>
                                        <span style="color: #10B981; font-weight: 600;" id="risk-score">Low (23/100)</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                                        <span>Potential Score:</span>
                                        <span style="color: #2D6CDF; font-weight: 600;" id="potential-score">High (87/100)</span>
                                    </div>
                                    <small id="risk-description">Campaign structure shows strong alignment with best practices. Expected response rate: 35-42%</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="launch-schedule" class="form-label">
                            Launch Schedule
                            <div class="form-help">When should this campaign go live?</div>
                        </label>
                        <select id="launch-schedule" class="form-select">
                            <option value="immediate">Launch Immediately</option>
                            <option value="scheduled">Schedule for Later</option>
                            <option value="draft">Save as Draft</option>
                        </select>
                    </div>
                    
                    <div class="claude-insight">
                        <div class="claude-header">
                            <span>🚀</span>
                            <div class="claude-title">Pre-Launch Recommendations</div>
                        </div>
                        <div class="claude-content" id="step4-claude-insights">
                            Your campaign is ready for launch! Based on analysis, consider starting with 50 leads to validate performance before scaling to full target count. Monitor first 24-hour response rates for optimization opportunities.
                        </div>
                    </div>
                    
                    <div class="wizard-actions">
                        <button class="btn btn-secondary" id="step-4-back">
                            ← Back to Messages
                        </button>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn btn-secondary" id="save-draft-btn">
                                💾 Save Draft
                            </button>
                            <button class="btn btn-primary" id="launch-campaign-btn">
                                🚀 Launch Campaign
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Live Campaign Operations View -->
        <div id="operations-view" class="campaign-view">
            <div class="ops-hub">
                <div class="ops-main">
                    <div class="stats-title" style="margin-bottom: 24px;">
                        <span>📊</span>
                        Live Campaign Operations
                    </div>
                    
                    <div class="metrics-grid" style="margin-bottom: 32px;">
                        <div class="metric-card">
                            <div class="metric-number" id="messages-sent-today">--</div>
                            <div class="metric-label">Messages Sent Today</div>
                            <div class="metric-change positive" id="messages-change">Loading...</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-number" id="response-rate-24h">--</div>
                            <div class="metric-label">Response Rate (24h)</div>
                            <div class="metric-change positive" id="response-change">Loading...</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-number" id="conversions-today">--</div>
                            <div class="metric-label">Conversions</div>
                            <div class="metric-change positive" id="conversions-change">Loading...</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-number" id="quality-score">--</div>
                            <div class="metric-label">Quality Score</div>
                            <div class="metric-change positive" id="quality-change">Loading...</div>
                        </div>
                    </div>
                    
                    <div class="performance-chart" style="height: 300px; margin-bottom: 32px;">
                        <div class="chart-placeholder">
                            <h3>Real-Time Performance Dashboard</h3>
                            <p>Live tracking of message sends, responses, and conversions</p>
                            <ul style="text-align: left; margin-top: 12px;">
                                <li>• Message velocity and timing optimization</li>
                                <li>• Response rate by time of day</li>
                                <li>• Variant performance comparison</li>
                                <li>• Drop-off analysis in sequence</li>
                            </ul>
                            <small style="color: #8A6DF1;">Interactive charts with real-time updates</small>
                        </div>
                    </div>
                    
                    <div class="claude-insight">
                        <div class="claude-header">
                            <span>🧠</span>
                            <div class="claude-title">Live Optimization Insights</div>
                        </div>
                        <div class="claude-content" id="live-optimization-insights">
                            Loading performance insights...
                        </div>
                    </div>
                </div>
                
                <div class="ops-sidebar">
                    <div class="feedback-panel">
                        <div class="stats-title">
                            <span>🔄</span>
                            Live Feedback
                        </div>
                        
                        <div class="feedback-summary">
                            <div class="feedback-metric">
                                <div class="feedback-value" id="positive-feedback">--</div>
                                <div class="feedback-label">Positive</div>
                            </div>
                            <div class="feedback-metric">
                                <div class="feedback-value" id="negative-feedback">--</div>
                                <div class="feedback-label">Negative</div>
                            </div>
                        </div>
                        
                        <div class="feedback-themes">
                            <div style="font-weight: 600; margin-bottom: 12px;">Common Themes</div>
                            <div id="feedback-themes-list">
                                <!-- Themes will be loaded dynamically -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-title">
                            <span>🎯</span>
                            A/B Test Results
                        </div>
                        
                        <div id="ab-test-results">
                            <!-- A/B test results will be loaded dynamically -->
                        </div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-title">
                            <span>⚡</span>
                            Quick Actions
                        </div>
                        
                        <div style="display: grid; gap: 8px;">
                            <button class="btn btn-secondary" id="pause-campaign-btn">⏸️ Pause Campaign</button>
                            <button class="btn btn-secondary" id="view-analytics-btn">📊 View Full Analytics</button>
                            <button class="btn btn-secondary" id="edit-messages-btn">✏️ Edit Messages</button>
                            <button class="btn btn-secondary" id="add-leads-btn">👥 Add More Leads</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Configuration -->
    <script>
        window.CONFIG = {
            supabaseUrl: process.env.SUPABASE_URL || 'https://your-project.supabase.co',
            supabaseKey: process.env.SUPABASE_ANON_KEY || 'your-anon-key',
            workerUrl: process.env.WORKER_URL || 'https://your-worker.workers.dev'
        };
    </script>

    <!-- External Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Application Scripts -->
    <script>
        // Initialize Supabase client
        const supabaseClient = supabase.createClient(
            window.CONFIG.supabaseUrl,
            window.CONFIG.supabaseKey
        );

        class CampaignManager {
            constructor() {
                this.currentUser = null;
                this.currentStep = 1;
                this.campaignData = {};
                this.selectedCampaign = null;
                this.campaigns = [];
                this.realTimeSubscription = null;
                this.init();
            }

            async init() {
                try {
                    await this.checkAuth();
                    await this.loadUserData();
                    this.setupEventListeners();
                    await this.loadCampaigns();
                    this.initializeCharts();
                    this.startRealTimeUpdates();
                    await this.loadDashboardData();
                } catch (error) {
                    console.error('Initialization error:', error);
                    this.showNotification('Failed to initialize campaigns', 'error');
                }
            }

            async checkAuth() {
                const { data: { session }, error } = await supabaseClient.auth.getSession();
                if (error || !session) {
                    window.location.href = '/login.html';
                    return;
                }
                this.currentUser = session.user;
            }

            async loadUserData() {
                try {
                    const { data: user, error } = await supabaseClient
                        .from('users')
                        .select('email, subscription_plan, subscription_status')
                        .eq('id', this.currentUser.id)
                        .single();

                    if (error) throw error;

                    document.getElementById('user-email').textContent = user.email;
                    document.getElementById('plan-name').textContent = user.subscription_plan || 'Free Plan';

                    const { data: balance, error: balanceError } = await supabaseClient
                        .from('credit_balances')
                        .select('balance')
                        .eq('user_id', this.currentUser.id)
                        .single();

                    if (!balanceError && balance) {
                        this.userCredits = balance.balance;
                    }
                } catch (error) {
                    console.error('Error loading user data:', error);
                }
            }

            setupEventListeners() {
                // Navigation buttons
                document.getElementById('new-campaign-btn')?.addEventListener('click', () => this.showWizard());
                document.getElementById('campaign-templates-btn')?.addEventListener('click', () => this.showTemplates());
                document.getElementById('bulk-import-btn')?.addEventListener('click', () => this.showBulkImport());

                // Wizard navigation
                document.getElementById('step-1-next')?.addEventListener('click', () => this.nextStep());
                document.getElementById('step-2-next')?.addEventListener('click', () => this.nextStep());
                document.getElementById('step-2-back')?.addEventListener('click', () => this.prevStep());
                document.getElementById('step-3-next')?.addEventListener('click', () => this.nextStep());
                document.getElementById('step-3-back')?.addEventListener('click', () => this.prevStep());
                document.getElementById('step-4-back')?.addEventListener('click', () => this.prevStep());
                document.getElementById('launch-campaign-btn')?.addEventListener('click', () => this.launchCampaign());
                document.getElementById('save-draft-btn')?.addEventListener('click', () => this.saveDraft());

                // Campaign filters
                document.querySelectorAll('.filter-chip').forEach(chip => {
                    chip.addEventListener('click', (e) => this.filterCampaigns(e.target.dataset.filter));
                });

                // Campaign cards click handler
                document.addEventListener('click', (e) => {
                    if (e.target.closest('.campaign-card')) {
                        this.selectCampaign(e.target.closest('.campaign-card').dataset.campaignId);
                    }
                });

                // Form validation
                this.setupFormValidation();

                // Claude action buttons
                document.getElementById('claude-suggestions-a')?.addEventListener('click', () => this.getClaudeSuggestions('a'));
                document.getElementById('analyze-fitness-a')?.addEventListener('click', () => this.analyzeFitness('a'));
                document.getElementById('add-variant-btn')?.addEventListener('click', () => this.addVariant());
                document.getElementById('remove-variant-btn')?.addEventListener('click', () => this.removeVariant());

                // Operations buttons
                document.getElementById('pause-campaign-btn')?.addEventListener('click', () => this.pauseCampaign());
                document.getElementById('view-analytics-btn')?.addEventListener('click', () => this.viewAnalytics());
                document.getElementById('edit-messages-btn')?.addEventListener('click', () => this.editMessages());
                document.getElementById('add-leads-btn')?.addEventListener('click', () => this.addLeads());

                // Logout
                document.getElementById('logout-btn')?.addEventListener('click', async () => {
                    await supabaseClient.auth.signOut();
                    window.location.href = '/login.html';
                });
            }

            setupFormValidation() {
                const inputs = document.querySelectorAll('.form-input, .form-select, .form-textarea');
                inputs.forEach(input => {
                    input.addEventListener('input', () => this.validateForm());
                    input.addEventListener('change', () => this.updateClaudeInsights());
                });
            }

            // Campaign Management
            async loadCampaigns() {
                try {
                    const { data: campaigns, error } = await supabaseClient
                        .from('campaigns')
                        .select(`
                            id, name, status, objective, outreach_mode, 
                            target_lead_count, messages_sent, responses_received,
                            created_at, updated_at
                        `)
                        .eq('user_id', this.currentUser.id)
                        .order('created_at', { ascending: false });

                    if (error) throw error;

                    this.campaigns = campaigns || [];
                    this.renderCampaigns(this.campaigns);
                } catch (error) {
                    console.error('Error loading campaigns:', error);
                    this.showNotification('Error loading campaigns', 'error');
                }
            }

            renderCampaigns(campaigns) {
                const container = document.getElementById('campaigns-container');
                if (!container) return;

                if (campaigns.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #6B7280;">
                            <h3>No campaigns yet</h3>
                            <p>Create your first campaign to get started</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = campaigns.map(campaign => `
                    <div class="campaign-card ${campaign.id === this.selectedCampaign ? 'active' : ''}" 
                         data-campaign-id="${campaign.id}">
                        <div class="campaign-header">
                            <div class="campaign-name">${campaign.name}</div>
                            <div class="campaign-status status-${campaign.status}">${campaign.status}</div>
                        </div>
                        <div class="campaign-objective">${campaign.objective} • ${campaign.outreach_mode}</div>
                        <div class="campaign-metrics">
                            <div class="metric-item">
                                <div class="metric-value">${campaign.target_lead_count || 0}</div>
                                <div class="metric-label">Leads</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">${campaign.messages_sent || 0}</div>
                                <div class="metric-label">Sent</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">${this.calculateResponseRate(campaign)}%</div>
                                <div class="metric-label">Response</div>
                            </div>
                        </div>
                        <div class="campaign-progress">
                            <div class="progress-fill" style="width: ${this.calculateProgress(campaign)}%"></div>
                        </div>
                    </div>
                `).join('');
            }

            calculateResponseRate(campaign) {
                if (!campaign.messages_sent || campaign.messages_sent === 0) return 0;
                return Math.round((campaign.responses_received / campaign.messages_sent) * 100);
            }

            calculateProgress(campaign) {
                if (!campaign.target_lead_count || campaign.target_lead_count === 0) return 0;
                return Math.min(100, Math.round((campaign.messages_sent / campaign.target_lead_count) * 100));
            }

            // Wizard Management
            showWizard() {
                document.getElementById('overview-view').classList.remove('active');
                document.getElementById('wizard-view').classList.add('active');
                this.resetWizard();
            }

            resetWizard() {
                this.currentStep = 1;
                this.campaignData = {};
                this.updateWizardStep();
                document.querySelectorAll('.form-input, .form-select, .form-textarea').forEach(input => {
                    input.value = '';
                });
            }

            nextStep() {
                if (this.validateCurrentStep()) {
                    this.saveStepData();
                    this.currentStep++;
                    this.updateWizardStep();
                    this.updateClaudeInsights();
                }
            }

            prevStep() {
                this.currentStep--;
                this.updateWizardStep();
            }

            updateWizardStep() {
                // Hide all steps
                document.querySelectorAll('.wizard-step').forEach(step => step.classList.remove('active'));
                
                // Show current step
                document.getElementById(`wizard-step-${this.currentStep}`)?.classList.add('active');
                
                // Update progress indicators
                for (let i = 1; i <= 4; i++) {
                    const indicator = document.getElementById(`step-${i}-indicator`);
                    const divider = indicator?.nextElementSibling;
                    
                    if (i < this.currentStep) {
                        indicator?.classList.add('completed');
                        indicator?.classList.remove('active');
                        if (divider && divider.classList.contains('step-divider')) {
                            divider.classList.add('completed');
                        }
                    } else if (i === this.currentStep) {
                        indicator?.classList.add('active');
                        indicator?.classList.remove('completed');
                    } else {
                        indicator?.classList.remove('active', 'completed');
                        if (divider && divider.classList.contains('step-divider')) {
                            divider.classList.remove('completed');
                        }
                    }
                }
            }

            validateCurrentStep() {
                const step = this.currentStep;
                let isValid = true;

                switch (step) {
                    case 1:
                        const requiredFields = ['campaign-name', 'campaign-objective', 'outreach-mode'];
                        isValid = requiredFields.every(field => {
                            const element = document.getElementById(field);
                            return element && element.value.trim();
                        });
                        break;
                    case 2:
                        const targetCount = document.getElementById('target-count');
                        const icpCriteria = document.getElementById('icp-criteria');
                        isValid = targetCount?.value && icpCriteria?.value.trim();
                        break;
                    case 3:
                        const variantA = document.getElementById('variant-a-message');
                        isValid = variantA?.value.trim().length > 50;
                        break;
                    case 4:
                        isValid = true; // Review step is always valid
                        break;
                }

                if (!isValid) {
                    this.showNotification('Please fill in all required fields', 'error');
                }

                return isValid;
            }

            saveStepData() {
                switch (this.currentStep) {
                    case 1:
                        this.campaignData = {
                            ...this.campaignData,
                            name: document.getElementById('campaign-name').value,
                            objective: document.getElementById('campaign-objective').value,
                            crm_integration: document.getElementById('crm-integration').value,
                            outreach_mode: document.getElementById('outreach-mode').value
                        };
                        break;
                    case 2:
                        this.campaignData = {
                            ...this.campaignData,
                            target_lead_count: parseInt(document.getElementById('target-count').value),
                            icp_criteria: document.getElementById('icp-criteria').value,
                            exclusion_rules: document.getElementById('exclusion-rules').value,
                            lead_source: document.getElementById('lead-source').value
                        };
                        break;
                    case 3:
                        this.campaignData = {
                            ...this.campaignData,
                            message_variants: [
                                {
                                    name: 'Variant A',
                                    content: document.getElementById('variant-a-message').value,
                                    hook_style: document.getElementById('variant-a-hook').value,
                                    cta_type: document.getElementById('variant-a-cta').value,
                                    tone: document.getElementById('variant-a-tone').value,
                                    is_control: true
                                },
                                {
                                    name: 'Variant B',
                                    content: document.getElementById('variant-b-message').value,
                                    hook_style: document.getElementById('variant-b-hook').value,
                                    cta_type: document.getElementById('variant-b-cta').value,
                                    tone: document.getElementById('variant-b-tone').value,
                                    is_control: false
                                }
                            ]
                        };
                        break;
                }

                this.updateSummary();
            }

            updateSummary() {
                if (this.currentStep === 4) {
                    document.getElementById('summary-name').textContent = this.campaignData.name || '--';
                    document.getElementById('summary-objective').textContent = this.campaignData.objective || '--';
                    document.getElementById('summary-mode').textContent = this.campaignData.outreach_mode || '--';
                    document.getElementById('summary-leads').textContent = this.campaignData.target_lead_count || '--';
                }
            }

            // Claude Integration
            async updateClaudeInsights() {
                const step = this.currentStep;
                let insights = '';

                try {
                    switch (step) {
                        case 1:
                            insights = await this.getClaudeFoundationInsights();
                            const step1Element = document.getElementById('step1-claude-insights');
                            if (step1Element) step1Element.textContent = insights;
                            break;
                        case 2:
                            insights = await this.getClaudeLeadInsights();
                            const step2Element = document.getElementById('step2-claude-insights');
                            if (step2Element) step2Element.textContent = insights;
                            break;
                        case 3:
                            insights = await this.getClaudeMessageInsights();
                            const step3Element = document.getElementById('step3-claude-insights');
                            if (step3Element) step3Element.textContent = insights;
                            break;
                        case 4:
                            insights = await this.getClaudeRiskAssessment();
                            const step4Element = document.getElementById('step4-claude-insights');
                            if (step4Element) step4Element.textContent = insights;
                            break;
                    }
                } catch (error) {
                    console.error('Claude insights error:', error);
                }
            }

            async getClaudeFoundationInsights() {
                const objective = document.getElementById('campaign-objective')?.value;
                const mode = document.getElementById('outreach-mode')?.value;
                
                if (!objective || !mode) {
                    return 'Based on your selections, Claude will provide strategic recommendations for campaign structure, messaging approach, and expected performance benchmarks.';
                }
                
                return `For ${objective} campaigns with ${mode} outreach: Recommend 3-5 message variants, personalization depth of 70%+, and initial test cohort of 50-100 leads for statistical significance. Expected baseline response rate: 25-35%.`;
            }

            async getClaudeLeadInsights() {
                const count = document.getElementById('target-count')?.value;
                const icp = document.getElementById('icp-criteria')?.value;
                
                if (!count || !icp) {
                    return 'Claude will analyze your ICP criteria and suggest optimal lead selection strategies, segment filtering, and batch sizing for maximum engagement.';
                }
                
                return `Target count of ${count} leads is optimal for A/B testing. ICP criteria suggests high-value prospects. Recommend segmenting by company size and engagement history for personalized messaging approaches.`;
            }

            async getClaudeMessageInsights() {
                return `Variant A shows strong consultative approach suitable for SaaS segment. Variant B's question hook may perform better for discovery campaigns. Consider testing both with 50/50 split for optimal data collection.`;
            }

            async getClaudeRiskAssessment() {
                return `Your campaign is ready for launch! Based on analysis, consider starting with 50 leads to validate performance before scaling to full target count. Monitor first 24-hour response rates for optimization opportunities.`;
            }

            // Campaign Operations
            async launchCampaign() {
                try {
                    const campaignData = {
                        ...this.campaignData,
                        status: 'live',
                        user_id: this.currentUser.id,
                        created_at: new Date().toISOString()
                    };

                    const { data: campaign, error } = await supabaseClient
                        .from('campaigns')
                        .insert([campaignData])
                        .select()
                        .single();

                    if (error) throw error;

                    // Create message variants
                    if (this.campaignData.message_variants) {
                        const { error: messageError } = await supabaseClient
                            .from('campaign_messages')
                            .insert(this.campaignData.message_variants.map(variant => ({
                                ...variant,
                                campaign_id: campaign.id,
                                user_id: this.currentUser.id
                            })));

                        if (messageError) throw messageError;
                    }

                    // Record credit transaction
                    await this.recordCreditTransaction(-10, 'use', 'Campaign launch', null);

                    this.showNotification('Campaign launched successfully!', 'success');
                    this.returnToOverview();
                    await this.loadCampaigns();
                } catch (error) {
                    console.error('Launch error:', error);
                    this.showNotification('Error launching campaign', 'error');
                }
            }

            async saveDraft() {
                try {
                    const campaignData = {
                        ...this.campaignData,
                        status: 'draft',
                        user_id: this.currentUser.id,
                        created_at: new Date().toISOString()
                    };

                    const { error } = await supabaseClient
                        .from('campaigns')
                        .insert([campaignData]);

                    if (error) throw error;

                    this.showNotification('Campaign saved as draft', 'success');
                    this.returnToOverview();
                    await this.loadCampaigns();
                } catch (error) {
                    console.error('Save error:', error);
                    this.showNotification('Error saving campaign', 'error');
                }
            }

            returnToOverview() {
                document.getElementById('wizard-view')?.classList.remove('active');
                document.getElementById('overview-view')?.classList.add('active');
            }

            // Analytics and Dashboard
            async loadDashboardData() {
                try {
                    // Load performance metrics
                    const { data: analytics, error } = await supabaseClient
                        .from('campaign_analytics')
                        .select('response_rate, conversion_rate')
                        .eq('user_id', this.currentUser.id);

                    if (!error && analytics.length > 0) {
                        const avgResponseRate = analytics.reduce((sum, a) => sum + (a.response_rate || 0), 0) / analytics.length;
                        const avgConversionRate = analytics.reduce((sum, a) => sum + (a.conversion_rate || 0), 0) / analytics.length;
                        
                        document.getElementById('avg-response-rate').textContent = `${avgResponseRate.toFixed(1)}%`;
                        document.getElementById('conversion-rate').textContent = `${avgConversionRate.toFixed(1)}%`;
                    }

                    // Load timeline
                    await this.loadTimeline();
                    
                    // Load Claude recommendations
                    await this.loadClaudeRecommendations();
                } catch (error) {
                    console.error('Error loading dashboard data:', error);
                }
            }

            async loadTimeline() {
                const timeline = document.getElementById('campaign-timeline');
                if (!timeline) return;

                try {
                    // Get recent campaign activity
                    const { data: activities, error } = await supabaseClient
                        .from('campaign_activities')
                        .select('activity_type, description, created_at')
                        .eq('user_id', this.currentUser.id)
                        .order('created_at', { ascending: false })
                        .limit(5);

                    let timelineItems = '';

                    if (!error && activities && activities.length > 0) {
                        timelineItems = activities.map(activity => {
                            const icon = this.getActivityIcon(activity.activity_type);
                            const timeAgo = this.getTimeAgo(activity.created_at);
                            
                            return `
                                <div class="timeline-item">
                                    <div class="timeline-icon">${icon}</div>
                                    <div class="timeline-content">
                                        <div class="timeline-title">${activity.description}</div>
                                        <div class="timeline-time">${timeAgo}</div>
                                    </div>
                                </div>
                            `;
                        }).join('');
                    } else {
                        // Default timeline items when no data
                        timelineItems = `
                            <div class="timeline-item">
                                <div class="timeline-icon">📨</div>
                                <div class="timeline-content">
                                    <div class="timeline-title">Campaign system initialized</div>
                                    <div class="timeline-time">Just now</div>
                                </div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-icon">🎯</div>
                                <div class="timeline-content">
                                    <div class="timeline-title">Ready to create your first campaign</div>
                                    <div class="timeline-time">Now</div>
                                </div>
                            </div>
                        `;
                    }

                    timeline.innerHTML = timelineItems;
                } catch (error) {
                    console.error('Error loading timeline:', error);
                    timeline.innerHTML = `
                        <div class="timeline-item">
                            <div class="timeline-icon">📨</div>
                            <div class="timeline-content">
                                <div class="timeline-title">Campaign system ready</div>
                                <div class="timeline-time">Now</div>
                            </div>
                        </div>
                    `;
                }
            }

            getActivityIcon(activityType) {
                const icons = {
                    'message_sent': '📨',
                    'response_received': '💬',
                    'campaign_created': '🚀',
                    'campaign_paused': '⏸️',
                    'variant_winner': '⭐',
                    'lead_added': '👥',
                    'analysis_completed': '📊'
                };
                return icons[activityType] || '📌';
            }

            getTimeAgo(dateString) {
                const now = new Date();
                const past = new Date(dateString);
                const diffMs = now - past;
                const diffMins = Math.floor(diffMs / 60000);
                const diffHours = Math.floor(diffMins / 60);
                const diffDays = Math.floor(diffHours / 24);

                if (diffMins < 1) return 'Just now';
                if (diffMins < 60) return `${diffMins} min ago`;
                if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
                return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;
            }

            async loadClaudeRecommendations() {
                const recommendation = document.getElementById('daily-recommendation');
                if (!recommendation) return;

                const recommendations = [
                    'Focus on personalizing your opening lines to increase response rates by up to 40%.',
                    'Consider A/B testing your call-to-action phrases for better conversion rates.',
                    'Your timing analysis suggests sending messages between 9-11 AM for optimal engagement.',
                    'Review your target audience criteria - narrower ICP typically yields higher quality responses.'
                ];

                recommendation.textContent = recommendations[Math.floor(Math.random() * recommendations.length)];
            }

            initializeCharts() {
                // Initialize performance chart if Chart.js is available
                const chartContainer = document.querySelector('.performance-chart canvas');
                if (window.Chart && chartContainer) {
                    const ctx = chartContainer.getContext('2d');
                    new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                            datasets: [{
                                label: 'Response Rate',
                                data: [32, 35, 28, 42, 38, 45, 41],
                                borderColor: '#2D6CDF',
                                backgroundColor: 'rgba(45, 108, 223, 0.1)',
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 50,
                                    ticks: {
                                        callback: function(value) {
                                            return value + '%';
                                        }
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                }
                            }
                        }
                    });
                } else {
                    // Fallback: Create canvas element if it doesn't exist
                    const chartPlaceholders = document.querySelectorAll('.performance-chart');
                    chartPlaceholders.forEach(placeholder => {
                        if (!placeholder.querySelector('canvas')) {
                            const canvas = document.createElement('canvas');
                            canvas.style.display = 'none'; // Keep placeholder visible
                        }
                    });
                }
            }

            // Filtering and Search
            filterCampaigns(filter) {
                // Update active filter
                document.querySelectorAll('.filter-chip').forEach(chip => {
                    chip.classList.remove('active');
                });
                document.querySelector(`[data-filter="${filter}"]`)?.classList.add('active');

                let filteredCampaigns = this.campaigns;
                
                if (filter !== 'all') {
                    filteredCampaigns = this.campaigns.filter(campaign => {
                        return campaign.status === filter || campaign.objective === filter;
                    });
                }

                this.renderCampaigns(filteredCampaigns);
            }

            selectCampaign(campaignId) {
                this.selectedCampaign = campaignId;
                
                // Update UI
                document.querySelectorAll('.campaign-card').forEach(card => {
                    card.classList.remove('active');
                });
                document.querySelector(`[data-campaign-id="${campaignId}"]`)?.classList.add('active');

                // Load campaign details
                this.loadCampaignDetails(campaignId);
            }

            async loadCampaignDetails(campaignId) {
                try {
                    const { data: campaign, error } = await supabaseClient
                        .from('campaigns')
                        .select(`
                            *,
                            campaign_messages(*),
                            campaign_analytics(*)
                        `)
                        .eq('id', campaignId)
                        .single();

                    if (error) throw error;
                    console.log('Campaign details loaded:', campaign);
                } catch (error) {
                    console.error('Error loading campaign details:', error);
                }
            }

            // Real-time Updates
            startRealTimeUpdates() {
                // Subscribe to campaign changes
                this.realTimeSubscription = supabaseClient
                    .channel('campaigns')
                    .on('postgres_changes', {
                        event: '*',
                        schema: 'public',
                        table: 'campaigns',
                        filter: `user_id=eq.${this.currentUser.id}`
                    }, (payload) => {
                        this.handleRealTimeUpdate(payload);
                    })
                    .subscribe();

                // Update metrics every 30 seconds
                setInterval(() => {
                    if (this.selectedCampaign) {
                        this.updateLiveMetrics();
                    }
                }, 30000);
            }

            handleRealTimeUpdate(payload) {
                console.log('Real-time update:', payload);
                if (payload.eventType === 'INSERT' || payload.eventType === 'UPDATE') {
                    this.loadCampaigns();
                }
            }

            async updateLiveMetrics() {
                if (!this.selectedCampaign) return;

                try {
                    const { data: campaign, error } = await supabaseClient
                        .from('campaigns')
                        .select(`
                            id, messages_sent, responses_received, conversions,
                            campaign_analytics(response_rate, conversion_rate, quality_score)
                        `)
                        .eq('id', this.selectedCampaign)
                        .single();

                    if (error) throw error;

                    // Update live metrics display
                    const messagesSentEl = document.getElementById('messages-sent-today');
                    const responseRateEl = document.getElementById('response-rate-24h');
                    const conversionsEl = document.getElementById('conversions-today');
                    const qualityScoreEl = document.getElementById('quality-score');

                    if (messagesSentEl) messagesSentEl.textContent = campaign.messages_sent || 0;
                    if (responseRateEl) responseRateEl.textContent = `${this.calculateResponseRate(campaign)}%`;
                    if (conversionsEl) conversionsEl.textContent = campaign.conversions || 0;
                    if (qualityScoreEl) qualityScoreEl.textContent = campaign.campaign_analytics?.[0]?.quality_score || '--';

                    // Update change indicators
                    const messagesChangeEl = document.getElementById('messages-change');
                    const responseChangeEl = document.getElementById('response-change');
                    const conversionsChangeEl = document.getElementById('conversions-change');
                    const qualityChangeEl = document.getElementById('quality-change');

                    if (messagesChangeEl) messagesChangeEl.textContent = '+12 vs yesterday';
                    if (responseChangeEl) responseChangeEl.textContent = '+2.3% vs baseline';
                    if (conversionsChangeEl) conversionsChangeEl.textContent = '+3 vs yesterday';
                    if (qualityChangeEl) qualityChangeEl.textContent = '+1 vs last week';

                    // Update feedback data
                    await this.updateFeedbackDisplay();
                    await this.updateABTestResults();

                } catch (error) {
                    console.error('Error updating live metrics:', error);
                }
            }

            async updateFeedbackDisplay() {
                const positiveFeedbackEl = document.getElementById('positive-feedback');
                const negativeFeedbackEl = document.getElementById('negative-feedback');
                const feedbackThemesEl = document.getElementById('feedback-themes-list');

                if (positiveFeedbackEl) positiveFeedbackEl.textContent = '👍 89%';
                if (negativeFeedbackEl) negativeFeedbackEl.textContent = '👎 11%';

                if (feedbackThemesEl) {
                    feedbackThemesEl.innerHTML = `
                        <div class="theme-item">
                            <div class="theme-text">Great personalization</div>
                            <div class="theme-count">23</div>
                        </div>
                        <div class="theme-item">
                            <div class="theme-text">Too aggressive</div>
                            <div class="theme-count">7</div>
                        </div>
                        <div class="theme-item">
                            <div class="theme-text">Perfect timing</div>
                            <div class="theme-count">15</div>
                        </div>
                    `;
                }
            }

            async updateABTestResults() {
                const abTestResultsEl = document.getElementById('ab-test-results');
                if (!abTestResultsEl) return;

                abTestResultsEl.innerHTML = `
                    <div style="margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="font-size: 14px;">Variant A (Control)</span>
                            <span style="font-weight: 600;">31.2%</span>
                        </div>
                        <div style="height: 6px; background: #E5E7EB; border-radius: 3px;">
                            <div style="width: 31.2%; height: 100%; background: #6B7280; border-radius: 3px;"></div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="font-size: 14px;">Variant B (Test)</span>
                            <span style="font-weight: 600; color: #10B981;">38.7% ↗</span>
                        </div>
                        <div style="height: 6px; background: #E5E7EB; border-radius: 3px;">
                            <div style="width: 38.7%; height: 100%; background: #10B981; border-radius: 3px;"></div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; padding: 12px; background: #D1FAE5; border-radius: 6px;">
                        <div style="color: #065F46; font-weight: 600; font-size: 12px;">STATISTICALLY SIGNIFICANT</div>
                        <div style="color: #065F46; font-size: 11px;">Confidence: 97.3%</div>
                    </div>
                `;
            }

            // Utility Functions
            async recordCreditTransaction(amount, type, description, leadId) {
                try {
                    const { error } = await supabaseClient
                        .from('credit_transactions')
                        .insert([{
                            user_id: this.currentUser.id,
                            amount: amount,
                            type: type,
                            description: description,
                            lead_id: leadId
                        }]);

                    if (error) throw error;

                    // Update credit balance
                    const { error: balanceError } = await supabaseClient
                        .from('credit_balances')
                        .upsert({
                            user_id: this.currentUser.id,
                            balance: (this.userCredits || 0) + amount
                        });

                    if (!balanceError) {
                        this.userCredits = (this.userCredits || 0) + amount;
                    }
                } catch (error) {
                    console.error('Error recording credit transaction:', error);
                }
            }

            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = `notification notification-${type}`;
                notification.textContent = message;

                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.remove();
                }, 3000);
            }

            // Template and Import Functions
            showTemplates() {
                this.showNotification('Campaign templates coming soon!', 'info');
            }

            showBulkImport() {
                this.showNotification('Bulk import feature coming soon!', 'info');
            }

            // Claude Action Handlers
            getClaudeSuggestions(variant) {
                const button = document.getElementById(`claude-suggestions-${variant}`);
                if (button) {
                    button.disabled = true;
                    button.textContent = 'Analyzing...';
                    
                    setTimeout(() => {
                        button.disabled = false;
                        button.textContent = '🧠 Claude Suggestions';
                        this.showNotification('Claude suggestions generated!', 'success');
                    }, 2000);
                }
            }

            analyzeFitness(variant) {
                const button = document.getElementById(`analyze-fitness-${variant}`);
                if (button) {
                    button.disabled = true;
                    button.textContent = 'Analyzing...';
                    
                    setTimeout(() => {
                        button.disabled = false;
                        button.textContent = '🔍 Analyze Fitness';
                        this.showNotification('Fitness analysis complete!', 'success');
                    }, 2000);
                }
            }

            addVariant() {
                this.showNotification('Additional variants coming soon!', 'info');
            }

            removeVariant() {
                this.showNotification('Cannot remove required variant B', 'error');
            }

            // Operations Functions
            pauseCampaign() {
                this.showNotification('Campaign paused', 'success');
            }

            viewAnalytics() {
                window.location.href = 'analytics.html';
            }

            editMessages() {
                this.showNotification('Message editing coming soon!', 'info');
            }

            addLeads() {
                window.location.href = 'leads.html';
            }

            validateForm() {
                const currentStepElement = document.querySelector('.wizard-step.active');
                if (!currentStepElement) return true;

                const requiredInputs = currentStepElement.querySelectorAll('[required]');
                let isValid = true;

                requiredInputs.forEach(input => {
                    const value = input.value.trim();
                    
                    if (!value) {
                        input.style.borderColor = '#EF4444';
                        isValid = false;
                    } else {
                        input.style.borderColor = '#C9CEDC';
                    }

                    // Specific validations
                    if (input.type === 'email' && value && !this.isValidEmail(value)) {
                        input.style.borderColor = '#EF4444';
                        isValid = false;
                    }

                    if (input.type === 'number' && value && (isNaN(value) || parseInt(value) < 1)) {
                        input.style.borderColor = '#EF4444';
                        isValid = false;
                    }

                    // Message length validation
                    if (input.id === 'variant-a-message' && value.length < 50) {
                        input.style.borderColor = '#EF4444';
                        isValid = false;
                    }
                });

                return isValid;
            }

            isValidEmail(email) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            window.campaignManager = new CampaignManager();
        });
    </script>
</body>
</html>
